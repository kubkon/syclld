# SYCL 2023 - Linker Workshop

This repo contains the source code and actual instructions for participating in the SYCL 2023
Linker Workshop in Vancouver.

## Part 1

In the first part of the workshop, we will learn how to parse the symbol and string tables in an ELF file.

Objectives:
* understand the format of the ELF file
* understand the concept of a section header (`shdr`)
* parse section headers and extract symbol and string tables

## Part 2

We will parse multiple input object files and resolve global symbols from among the specified object files.

Objectives:
* understand the concept of symbol binding (linkage): local, weak and global
* understand the concept of symbol collision
* build a map of resolved global symbols

## Part 3

Having the symbols resolved, it is now time to revisit ELF file format and parse sections and associated relocations.
For each section, we will associate symbols we extracted in Part 2, and we will generate a mapping into an output
section.

Objectives:
* understand section types and how to parse section's data from the input object file
* understand how section types are combined together into some output section
* build a list of parsed sections with associated symbols and relocations

## Part 4

Some relocations as generated by the compiler will require the existence of an indirection via a pointer in a
global offset table (GOT). In this part of the workshop, we will learn how to scan the relocations for each
parsed section and create such pointers.

Objectives:
* understand the concept of a relocation type: `R_X86_64_64`, `R_x86_64_GOTPCREL`, etc.
* scan reloctions in each parsed input section and create a GOT pointer for each encountered relocation that
  requires it

## Part 5

By this point, we have the information necessary to allocate symbols in each output section relative to the start
address of that section, and its size. In other words, we do not create the final allocation in virtual memory yet,
but instead work out partial offsets that are to be correctly aligned within the output section.

Objectives:
* understand the concept of alignment in memory
* understand that GOT is a special, synthetic section and doesn't need to get symbols allocated
* build a list of all symbols in each output section correctly allocated wrt to the start of the said section

## Part 6

Sort and allocate output sections in virtual memory. Create program headers combining multiple matching sections
into a single segment sharing the same permission attributes.

Objectives:
* understand the concept of memory permission in a loadable (`alloc`) segment
* build a list of program headers, section headers, and output sections fully allocated in virtual memory

## Part 7

For each output section, resolve relocations and commit to a file.

Objectives:
* understand the format of a relocation type (`Elf64_Rela`)
* understand how to correctly resolve each relocation type
* write the resolved chunks to the output file at the correct file offsets

## Part 8

Commit string tables, header, program and section headers to a file.

Objectives:
* create a valid ELF header
* commit program and section headers in appropriate locations within the file

